<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" -ext WixUIExtension -ext WixUtilExtension -dx64=0
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -ext WixUtilExtension -loc OpenShellText-en-US.wxl
-->
<?if $(var.x64)=1 ?>
<?define CS_UPGRADE = "779A74EF-23DE-4C71-AC12-2EE5A542ED34"?>
<?define CS_PLATFORM  = "x64"?>
<?define CS_PROGRAM_FILES  = "ProgramFiles64Folder"?>
<?define CS_WIN64  = "yes"?>
<?else ?>
<?define CS_UPGRADE = "EB7DA1D9-44EA-43BF-8A08-0B103007D4F2"?>
<?define CS_PLATFORM  = "x86"?>
<?define CS_PROGRAM_FILES  = "ProgramFilesFolder"?>
<?define CS_WIN64  = "no"?>
<?endif ?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="Open-Shell" Language="1033" Version="$(env.CS_VERSION)" Manufacturer="The Open-Shell Team" UpgradeCode="$(var.CS_UPGRADE)">
		<Package Description="Open-Shell" Comments="Start Menu Replacement" InstallerVersion="500" Compressed="yes" Platform="$(var.CS_PLATFORM)" />
		<Media Id="1" Cabinet="cshell.cab" EmbedCab="yes" CompressionLevel="high" />
		<Media Id="2" Cabinet="simple.cab" EmbedCab="yes" CompressionLevel="high" />
		<?if $(var.x64)=0 ?>
		<Condition Message="!(loc.Error32bit)">not Msix64</Condition>
		<?endif ?>
		<Condition Message="!(loc.ErrorWin7)">VersionNT&gt;=601</Condition>
		<Condition Message="!(loc.ErrorNewVersion)">NOT NEWERPRODUCTFOUND OR Installed</Condition>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="$(var.CS_PROGRAM_FILES)" Name="PFiles">
				<Directory Id="APPLICATIONFOLDER" Name="Open-Shell">
					<Directory Id="Skins" Name="Skins" />
				</Directory>
			</Directory>
			<Directory Id="ProgramMenuFolder" Name="Programs">
				<Directory Id="StartMenuDir" Name="Open-Shell">
					<Component Id="StartMenuDir" Guid="42AA415A-5E61-4238-96B2-A997D1EE5521">
						<RemoveFolder Id="StartMenuDir" On="uninstall" />
						<CreateFolder />
						<Condition>START_MENU_FOLDER=1</Condition>
					</Component>
				</Directory>
			</Directory>
			<Directory Id="SystemFolder" />
			<Directory Id="System64Folder" />
		</Directory>
		<Feature Id="OpenShell" Level="1" Title="Open-Shell" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Absent="disallow" Display="expand"  Description="!(loc.OpenShellDesc)">
			<ComponentRef Id="OpenShell.chm" />
			<ComponentRef Id="OpenShellReadme.rtf" />
			<ComponentRef Id="OpenShell" />
			<ComponentRef Id="TreatAs" />
			<ComponentRef Id="HelpLink" />
			<ComponentRef Id="ReadmeLink" />
			<ComponentRef Id="StartMenuDir" />
			<ComponentRef Id="PolicyDefinitions.zip" />
			<?if $(var.CS_LANG_NAME)!="en-US" ?>
			<ComponentRef Id="LanguageDll" />
			<?endif ?>
			<Feature Id="ClassicExplorer" Level="1" Title="!(loc.ExplorerTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.ExplorerDesc)">
				<ComponentRef Id="ClassicExplorer32.dll" />
				<?if $(var.x64)=1 ?>
				<ComponentRef Id="ClassicExplorer64.dll" />
				<?endif ?>
				<ComponentRef Id="ExplorerL10N.ini" />
				<ComponentRef Id="ClassicExplorerSettings.exe" />
				<ComponentRef Id="ExplorerSettingsLink" />
			</Feature>
			<Feature Id="StartMenu" Level="1" Title="!(loc.StartMenuTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.StartMenuDesc)">
				<ComponentRef Id="StartMenu.exe" />
				<ComponentRef Id="StartMenuDLL.dll" />
				<ComponentRef Id="StartMenuL10N.ini" />
				<ComponentRef Id="StartMenuHelper32.dll" />
				<?if $(var.x64)=1 ?>
				<ComponentRef Id="StartMenuHelper64.dll" />
				<?endif ?>
				<ComponentRef Id="StartScreenLink" />
				<ComponentRef Id="StartMenuHelperL10N.ini" />
				<ComponentRef Id="ClassicSkin.skin" />
				<ComponentRef Id="FullGlass.skin" />
				<ComponentRef Id="SmokedGlass.skin" />
				<ComponentRef Id="WindowsAero.skin" />
				<ComponentRef Id="WindowsBasic.skin" />
				<ComponentRef Id="WindowsXPLuna.skin" />
				<ComponentRef Id="Windows8.skin" />
				<ComponentRef Id="Metro.skin" />
				<ComponentRef Id="ClassicSkin.skin7" />
				<ComponentRef Id="WindowsAero.skin7" />
				<ComponentRef Id="Windows8.skin7" />
				<ComponentRef Id="Midnight.skin7" />
				<ComponentRef Id="Metro.skin7" />
				<ComponentRef Id="Metallic.skin7" />
				<ComponentRef Id="AutoRun" />
				<ComponentRef Id="MenuSettingsLink" />
			</Feature>
			<Feature Id="ClassicIE" Level="2" Title="!(loc.IETitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.IEDesc)">
				<ComponentRef Id="ClassicIEDLL_32.dll" />
				<ComponentRef Id="ClassicIE_32.exe" />
				<?if $(var.x64)=1 ?>
				<ComponentRef Id="ClassicIEDLL_64.dll" />
				<ComponentRef Id="ClassicIE_64.exe" />
				<?endif ?>
				<ComponentRef Id="IESettingsLink" />
				<Condition Level="1">IE_BUILD&gt;=90000</Condition>
			</Feature>
			<Feature Id="Update" Level="1" Title="!(loc.UpdateTitle)" ConfigurableDirectory="APPLICATIONFOLDER" AllowAdvertise="no" Description="!(loc.UpdateDesc)">
				<ComponentRef Id="Update.exe" />
				<ComponentRef Id="DesktopToasts.dll" />
				<ComponentRef Id="UpdateSettingsLink" />
				<ComponentRef Id="ToastActivator" />
			</Feature>
		</Feature>
		<UI>
			<TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
			<TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
			<TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />
			<Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
			<Property Id="WixUI_Mode" Value="FeatureTree" />
			<DialogRef Id="ErrorDlg" />
			<DialogRef Id="FatalError" />
			<DialogRef Id="FilesInUse" />
			<DialogRef Id="MsiRMFilesInUse" />
			<DialogRef Id="PrepareDlg" />
			<DialogRef Id="ProgressDlg" />
			<DialogRef Id="ResumeDlg" />
			<DialogRef Id="UserExit" />
			<Publish Dialog="ExitDialog2" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
			<Publish Dialog="WelcomeDlg2" Control="Next" Event="NewDialog" Value="LicenseAgreementDlg2">1</Publish>
			<Publish Dialog="LicenseAgreementDlg2" Control="Back" Event="NewDialog" Value="WelcomeDlg2">1</Publish>
			<Publish Dialog="LicenseAgreementDlg2" Control="Next" Event="NewDialog" Value="CustomizeDlg2">LicenseAccepted = "1"</Publish>
			<Publish Dialog="CustomizeDlg2" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg2" Order="1">Installed</Publish>
			<Publish Dialog="CustomizeDlg2" Control="Back" Event="NewDialog" Value="LicenseAgreementDlg2" Order="2">NOT Installed</Publish>
			<Publish Dialog="CustomizeDlg2" Control="Next" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
			<Publish Dialog="VerifyReadyDlg2" Control="Back" Event="NewDialog" Value="CustomizeDlg2" Order="1">NOT Installed OR WixUI_InstallMode = "Change"</Publish>
			<Publish Dialog="VerifyReadyDlg2" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg2" Order="2">Installed</Publish>
			<Publish Dialog="MaintenanceWelcomeDlg2" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg2">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg2" Control="ChangeButton" Event="NewDialog" Value="CustomizeDlg2">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg2" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg2" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg2">1</Publish>
			<Publish Dialog="MaintenanceTypeDlg2" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg2">1</Publish>
			<Dialog Id="WelcomeDlg2" Width="370" Height="270" Title="!(loc.WelcomeDlg_Title)">
				<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)" />
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="!(loc.WelcomeDlgBitmap)" />
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
				<Control Id="Description" Type="Text" X="135" Y="80" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.WelcomeDlgDescription)" />
				<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.WelcomeDlgTitle)" />
			</Dialog>
			<InstallUISequence>
				<Show Dialog="WelcomeDlg2" Before="ProgressDlg">NOT Installed</Show>
			</InstallUISequence>
			<Dialog Id="LicenseAgreementDlg2" Width="370" Height="270" Title="!(loc.LicenseAgreementDlg_Title)">
				<Control Id="LicenseAcceptedCheckBox" Type="CheckBox" X="20" Y="207" Width="330" Height="18" CheckBoxValue="1" Property="LicenseAccepted" Text="!(loc.LicenseAgreementDlgLicenseAcceptedCheckBox)" />
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
				<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
					<Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">CostingComplete = 1</Publish>
					<Condition Action="disable"><![CDATA[LicenseAccepted <> "1"]]></Condition>
					<Condition Action="enable">LicenseAccepted = "1"</Condition>
				</Control>
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.LicenseAgreementDlgBannerBitmap)" />
				<Control Id="LicenseText" Type="ScrollableText" X="20" Y="60" Width="330" Height="140" Sunken="yes" TabSkip="no">
					<Text SourceFile="..\Localization\$(var.CS_LANG_FOLDER)\OpenShellEULA.rtf" />
				</Control>
				<Control Id="Print" Type="PushButton" X="100" Y="243" Width="56" Height="17" Text="!(loc.WixUIPrint)">
					<Publish Event="DoAction" Value="WixUIPrintEula">1</Publish>
				</Control>
				<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
				<Control Id="Description" Type="Text" X="25" Y="23" Width="340" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.LicenseAgreementDlgDescription)" />
				<Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.LicenseAgreementDlgTitle)" />
			</Dialog>
			<Dialog Id="CustomizeDlg2" Width="370" Height="270" Title="!(loc.CustomizeDlg_Title)" TrackDiskSpace="yes">
				<Control Id="Tree" Type="SelectionTree" X="25" Y="85" Width="175" Height="92" Property="_BrowseProperty" Sunken="yes" TabSkip="no" Text="!(loc.CustomizeDlgTree)" />
				<Control Id="Browse" Type="PushButton" X="294" Y="212" Width="66" Height="17" Text="!(loc.CustomizeDlgBrowse)">
					<Publish Event="SelectionBrowse" Value="BrowseDlg">1</Publish>
					<Condition Action="hide">Installed</Condition>
					<Condition Action="disable">Installed</Condition>
				</Control>
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
				<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
					<Subscribe Event="SelectionNoItems" Attribute="Enabled" />
				</Control>
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.CustomizeDlgBannerBitmap)" />
				<Control Id="Text" Type="Text" X="25" Y="55" Width="320" Height="20" Text="!(loc.CustomizeDlgText)" />
				<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="2" />
				<Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.CustomizeDlgDescription)" />
				<Control Id="Title" Type="Text" X="15" Y="6" Width="210" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.CustomizeDlgTitle)" />
				<Control Id="Box" Type="GroupBox" X="210" Y="81" Width="150" Height="118" />
				<Control Id="ItemDescription" Type="Text" X="215" Y="90" Width="131" Height="50" Text="!(loc.CustomizeDlgItemDescription)">
					<Subscribe Event="SelectionDescription" Attribute="Text" />
				</Control>
				<Control Id="ItemSize" Type="Text" X="215" Y="140" Width="131" Height="50" Text="!(loc.CustomizeDlgItemSize)">
					<Subscribe Event="SelectionSize" Attribute="Text" />
				</Control>
				<Control Id="Location" Type="Text" X="90" Y="214" Width="200" Height="20" Text="!(loc.CustomizeDlgLocation)">
					<Subscribe Event="SelectionPath" Attribute="Text" />
					<Subscribe Event="SelectionPathOn" Attribute="Visible" />
					<Condition Action="hide">Installed</Condition>
				</Control>
				<Control Id="LocationLabel" Type="Text" X="25" Y="214" Width="65" Height="10" Text="!(loc.CustomizeDlgLocationLabel)">
					<Subscribe Event="SelectionPathOn" Attribute="Visible" />
					<Condition Action="hide">Installed</Condition>
				</Control>
				<Control Type="CheckBox" Id="StartMenu" Width="172" Height="17" X="25" Y="181" Text="!(loc.StartMenuFolder)" Property="START_MENU_FOLDER" CheckBoxValue="1">
					<Condition Action="hide">Installed</Condition>
				</Control>
				<Control Type="Line" Id="MiddleLine" Width="370" Height="17" X="0" Y="205">
					<Condition Action="hide">Installed</Condition>
				</Control>
			</Dialog>
			<Dialog Id="VerifyReadyDlg2" Width="370" Height="270" Title="!(loc.VerifyReadyDlg_Title)" TrackDiskSpace="yes">
				<Control Id="Install" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgInstall)">
					<Condition Action="show">NOT Installed AND ALLUSERS</Condition>
					<Condition Action="enable">NOT Installed</Condition>
					<Condition Action="default">NOT Installed</Condition>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="InstallNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgInstall)">
					<Condition Action="show">NOT Installed AND NOT ALLUSERS</Condition>
					<Condition Action="enable">NOT Installed</Condition>
					<Condition Action="default">NOT Installed</Condition>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="Change" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgChange)">
					<Condition Action="show">WixUI_InstallMode = "Change" AND ALLUSERS AND (ADDLOCAL OR REMOVE)</Condition>
					<Condition Action="enable">WixUI_InstallMode = "Change"</Condition>
					<Condition Action="default">WixUI_InstallMode = "Change"</Condition>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="ChangeNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgChange)">
					<Condition Action="show">WixUI_InstallMode = "Change" AND (NOT ALLUSERS OR (NOT ADDLOCAL AND NOT REMOVE))</Condition>
					<Condition Action="enable">WixUI_InstallMode = "Change"</Condition>
					<Condition Action="default">WixUI_InstallMode = "Change"</Condition>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="Repair" Type="PushButton" X="236" Y="243" Width="66" Height="17" Default="yes" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRepair)">
					<Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
					<Condition Action="enable">WixUI_InstallMode = "Repair"</Condition>
					<Condition Action="default">WixUI_InstallMode = "Repair"</Condition>
					<Publish Event="ReinstallMode" Value="ecmus"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="Reinstall" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="Remove" Type="PushButton" ElevationShield="yes" X="236" Y="243" Width="66" Height="17" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRemove)">
					<Condition Action="show">WixUI_InstallMode = "Remove" AND ALLUSERS</Condition>
					<Condition Action="enable">WixUI_InstallMode = "Remove"</Condition>
					<Publish Event="Remove" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="RemoveNoShield" Type="PushButton" ElevationShield="no" X="236" Y="243" Width="66" Height="17" Hidden="yes" Disabled="yes" Text="!(loc.VerifyReadyDlgRemove)">
					<Condition Action="show">WixUI_InstallMode = "Remove" AND NOT ALLUSERS</Condition>
					<Condition Action="enable">WixUI_InstallMode = "Remove"</Condition>
					<Publish Event="Remove" Value="All"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="EndDialog" Value="Return"><![CDATA[OutOfDiskSpace <> 1]]></Publish>
					<Publish Event="SpawnDialog" Value="OutOfRbDiskDlg">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND (PROMPTROLLBACKCOST="P" OR NOT PROMPTROLLBACKCOST)</Publish>
					<Publish Event="EndDialog" Value="Return">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="EnableRollback" Value="False">OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 0 AND PROMPTROLLBACKCOST="D"</Publish>
					<Publish Event="SpawnDialog" Value="OutOfDiskDlg">(OutOfDiskSpace = 1 AND OutOfNoRbDiskSpace = 1) OR (OutOfDiskSpace = 1 AND PROMPTROLLBACKCOST="F")</Publish>
				</Control>
				<Control Id="InstallTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgInstallTitle)">
					<Condition Action="show">NOT Installed</Condition>
				</Control>
				<Control Id="InstallText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" Text="!(loc.VerifyReadyDlgInstallText)">
					<Condition Action="show">NOT Installed</Condition>
				</Control>
				<Control Id="ChangeTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgChangeTitle)">
					<Condition Action="show">WixUI_InstallMode = "Change"</Condition>
				</Control>
				<Control Id="ChangeText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" Text="!(loc.VerifyReadyDlgChangeText)">
					<Condition Action="show">WixUI_InstallMode = "Change"</Condition>
				</Control>
				<Control Id="RepairTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgRepairTitle)">
					<Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
				</Control>
				<Control Id="RepairText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" NoPrefix="yes" Text="!(loc.VerifyReadyDlgRepairText)">
					<Condition Action="show">WixUI_InstallMode = "Repair"</Condition>
				</Control>
				<Control Id="RemoveTitle" Type="Text" X="15" Y="15" Width="300" Height="15" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="!(loc.VerifyReadyDlgRemoveTitle)">
					<Condition Action="show">WixUI_InstallMode = "Remove"</Condition>
				</Control>
				<Control Id="RemoveText" Type="Text" X="25" Y="70" Width="320" Height="80" Hidden="yes" NoPrefix="yes" Text="!(loc.VerifyReadyDlgRemoveText)">
					<Condition Action="show">WixUI_InstallMode = "Remove"</Condition>
				</Control>
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)">
					<Condition Action="default">WixUI_InstallMode = "Remove"</Condition>
				</Control>
				<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.VerifyReadyDlgBannerBitmap)" />
				<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
			</Dialog>
			<Dialog Id="MaintenanceWelcomeDlg2" Width="370" Height="270" Title="!(loc.MaintenanceWelcomeDlg_Title)">
				<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="!(loc.WixUINext)">
					<Publish Event="SpawnWaitDialog" Value="WaitForCostingDlg">CostingComplete = 1</Publish>
				</Control>
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="!(loc.MaintenanceWelcomeDlgBitmap)" />
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
				<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceWelcomeDlgTitle)" />
				<Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceWelcomeDlgDescription)" />
			</Dialog>
			<InstallUISequence>
				<Show Dialog="MaintenanceWelcomeDlg2" Before="ProgressDlg">Installed AND NOT RESUME AND NOT Preselected</Show>
			</InstallUISequence>
			<Dialog Id="MaintenanceTypeDlg2" Width="370" Height="270" Title="!(loc.MaintenanceTypeDlg_Title)">
				<Control Id="ChangeButton" Type="PushButton" X="40" Y="65" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgChangeButtonTooltip)" Default="yes" Text="!(loc.MaintenanceTypeDlgChangeButton)">
					<Publish Property="WixUI_InstallMode" Value="Change">1</Publish>
				</Control>
				<Control Id="ChangeText" Type="Text" X="60" Y="85" Width="280" Height="20" Text="!(loc.MaintenanceTypeDlgChangeText)" />
				<Control Id="RepairButton" Type="PushButton" X="40" Y="118" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgRepairButtonTooltip)" Text="!(loc.MaintenanceTypeDlgRepairButton)">
					<Publish Property="WixUI_InstallMode" Value="Repair">1</Publish>
				</Control>
				<Control Id="RepairText" Type="Text" X="60" Y="138" Width="280" Height="30" Text="!(loc.MaintenanceTypeDlgRepairText)" />
				<Control Id="RemoveButton" Type="PushButton" X="40" Y="171" Width="80" Height="17" ToolTip="!(loc.MaintenanceTypeDlgRemoveButtonTooltip)" Text="!(loc.MaintenanceTypeDlgRemoveButton)">
					<Publish Property="WixUI_InstallMode" Value="Remove">1</Publish>
					<Condition Action="disable">ARPNOREMOVE</Condition>
				</Control>
				<Control Id="RemoveText" Type="Text" X="60" Y="191" Width="280" Height="20" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgRemoveText)">
					<Condition Action="hide">ARPNOREMOVE</Condition>
				</Control>
				<Control Id="RemoveDisabledText" Type="Text" X="60" Y="191" Width="280" Height="20" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgRemoveDisabledText)" Hidden="yes">
					<Condition Action="show">ARPNOREMOVE</Condition>
				</Control>
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="!(loc.WixUIBack)" />
				<Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUINext)" />
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="!(loc.WixUICancel)">
					<Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
				</Control>
				<Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="!(loc.MaintenanceTypeDlgBannerBitmap)" />
				<Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
				<Control Id="Title" Type="Text" X="15" Y="6" Width="340" Height="15" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgTitle)" />
				<Control Id="Description" Type="Text" X="25" Y="23" Width="340" Height="20" Transparent="yes" NoPrefix="yes" Text="!(loc.MaintenanceTypeDlgDescription)" />
			</Dialog>
			<Dialog Id="ExitDialog2" Width="370" Height="270" Title="!(loc.ExitDialog_Title)">
				<Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Cancel="yes" Text="!(loc.WixUIFinish)" />
				<Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUICancel)" />
				<Control Id="Bitmap1" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Hidden="yes" Text="!(loc.ExitDialogBitmap)">
					<Condition Action="show">Installed</Condition>
				</Control>
				<Control Id="Bitmap2" Type="Bitmap" X="0" Y="0" Width="370" Height="197" TabSkip="no" Hidden="yes" Text="dialog2.jpg">
					<Condition Action="show">NOT Installed</Condition>
				</Control>
				<Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="!(loc.WixUIBack)" />
				<Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
				<Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="40" Transparent="yes" NoPrefix="yes" Text="!(loc.ExitDialogDescription)" />
				<Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes" Text="!(loc.ExitDialogTitle)" />
				<Control Id="OptionalText" Type="Text" X="135" Y="110" Width="220" Height="80" Transparent="yes" NoPrefix="yes" Hidden="yes" Text="[WIXUI_EXITDIALOGOPTIONALTEXT]">
					<Condition Action="show">WIXUI_EXITDIALOGOPTIONALTEXT AND NOT Installed</Condition>
				</Control>
				<Control Type="Icon" Id="Icon1" Width="12" Height="12" X="7" Y="203" Hidden="yes" Text="web.ico">
					<Condition Action="show">NOT Installed</Condition>
				</Control>
				<Control Type="Hyperlink" Id="Link1" Width="131" Height="10" X="22" Y="204" Hidden="yes" ToolTip="https://open-shell.github.io/Open-Shell-Menu">
					<Text><![CDATA[<a href="https://open-shell.github.io/Open-Shell-Menu">!(loc.WebLink)</a>]]></Text>
					<Condition Action="show">NOT Installed</Condition>
				</Control>
			</Dialog>
			<InstallUISequence>
				<Show Dialog="ExitDialog2" OnExit="success" />
			</InstallUISequence>
			<AdminUISequence>
				<Show Dialog="ExitDialog2" OnExit="success" />
			</AdminUISequence>
		</UI>
		<UIRef Id="WixUI_Common" />
		<UIRef Id="WixUI_ErrorProgressText" />
		<DirectoryRef Id="APPLICATIONFOLDER">
			<Component Id="OpenShell.chm" Guid="29AB35F9-D611-4B34-BCE3-517C10C839AF" Win64="$(var.CS_WIN64)">
				<File Id="OpenShell.chm" KeyPath="yes" Source="..\Localization\$(var.CS_LANG_FOLDER)\OpenShell.chm" Vital="yes" />
			</Component>
			<Component Id="ClassicExplorer32.dll" Guid="21833BA5-3F17-4237-BA0C-2D01D273A27F" Win64="$(var.CS_WIN64)">
				<File Id="ClassicExplorer32.dll" KeyPath="yes" Source="Output\ClassicExplorer32.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
			<Component Id="ClassicExplorerSettings.exe" Guid="CBD00200-FAED-48F6-B8C1-F033BDB00A28" Win64="$(var.CS_WIN64)">
				<File Id="ClassicExplorerSettings.exe" KeyPath="yes" Source="Output\ClassicExplorerSettings.exe" Checksum="yes" Vital="yes" />
			</Component>
			<Component Id="ClassicIEDLL_32.dll" Guid="C85DEB7F-FB76-42E9-B1F4-7A7C7DCBD482" Win64="$(var.CS_WIN64)">
				<File Id="ClassicIEDLL_32.dll" KeyPath="yes" Source="Output\ClassicIEDLL_32.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
			<Component Id="ClassicIE_32.exe" Guid="0D0BF4CF-9753-4867-9DE5-69D3DA19DC41" Win64="$(var.CS_WIN64)">
				<File Id="ClassicIE_32.exe" KeyPath="yes" Source="Output\ClassicIE_32.exe" Checksum="yes" Vital="yes" />
				<Shortcut Id="IESettings" Name="IE Settings" Advertise="no" Description="!(loc.IESettingsDesc)" Target="[APPLICATIONFOLDER]ClassicIE_32.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.ClassicIE.Settings" />
				</Shortcut>
			</Component>
			<?if $(var.x64)=1 ?>
			<Component Id="ClassicExplorer64.dll" Guid="A82DBFC3-E19B-4E02-AF50-50363C2B0714" Win64="yes" DiskId="2">
				<File Id="ClassicExplorer64.dll" KeyPath="yes" Source="Output\x64\ClassicExplorer64.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
			<Component Id="ClassicIEDLL_64.dll" Guid="6EC7C9A0-BB8E-4B4F-9F63-D03EFEB65B41" Win64="yes" DiskId="2">
				<File Id="ClassicIEDLL_64.dll" KeyPath="yes" Source="Output\x64\ClassicIEDLL_64.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
			<Component Id="ClassicIE_64.exe" Guid="89BDF7B9-D8F4-46BE-9F29-344B384D753C" Win64="yes" DiskId="2">
				<File Id="ClassicIE_64.exe" KeyPath="yes" Source="Output\x64\ClassicIE_64.exe" Checksum="yes" Vital="yes" />
			</Component>
			<Component Id="StartMenu.exe" Guid="F74C0FF3-A8C0-4B6E-AFD2-F9467DE4D90B" Win64="yes" DiskId="2">
				<File Id="StartMenu.exe" KeyPath="yes" Checksum="yes" Source="Output\x64\StartMenu.exe" Vital="yes" />
				<Shortcut Id="StartMenuSettings" Name="Start Menu Settings" Advertise="no" Arguments="-settings" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]StartMenu.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.StartMenu.Settings" />
				</Shortcut>
			</Component>
			<Component Id="StartMenuDLL.dll" Guid="C5226061-17DE-4DF6-A088-CC84F6A7BE84" Win64="yes" DiskId="2">
				<File Id="StartMenuDLL.dll" Checksum="yes" KeyPath="yes" Source="Output\x64\StartMenuDLL.dll" Vital="yes" />
			</Component>
			<?else ?>
			<Component Id="StartMenu.exe" Guid="F74C0FF3-A8C0-4B6E-AFD2-F9467DE4D90B" Win64="no" DiskId="2">
				<File Id="StartMenu.exe" KeyPath="yes" Checksum="yes" Source="Output\StartMenu.exe" Vital="yes" />
				<Shortcut Id="StartMenuSettings" Name="Start Menu Settings" Advertise="no" Arguments="-settings" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]StartMenu.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.StartMenu.Settings" />
				</Shortcut>
			</Component>
			<Component Id="StartMenuDLL.dll" Guid="C5226061-17DE-4DF6-A088-CC84F6A7BE84" Win64="no" DiskId="2">
				<File Id="StartMenuDLL.dll" Checksum="yes" KeyPath="yes" Source="Output\StartMenuDLL.dll" Vital="yes" />
			</Component>
			<?endif ?>
			<Component Id="StartScreenLink" Guid="5C71165B-5451-417b-ADF5-86983ED2489A" Win64="$(var.CS_WIN64)">
				<Shortcut Id="StartScreen" Name="Start Screen" Advertise="no" Arguments="-togglenew" Description="!(loc.StartScreenDesc)" Target="[APPLICATIONFOLDER]StartMenu.exe" WorkingDirectory="APPLICATIONFOLDER" Icon="StartScreen.exe">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.StartMenu.StartScreen" />
					<ShortcutProperty Key="System.AppUserModel.StartPinOption" Value="1" />
					<ShortcutProperty Key="System.AppUserModel.ExcludeFromShowInNewInstall" Value="1" />
					<Icon Id="StartScreen.exe" SourceFile="..\StartMenu\StartMenuDLL\startb.ico" />
				</Shortcut>
				<CreateFolder />
				<Condition>VersionNT&gt;601</Condition>
			</Component>
			<Component Id="OpenShellReadme.rtf" Guid="A6B815ED-91BD-4F61-83B3-F98041026BB9" Win64="$(var.CS_WIN64)">
				<File Id="OpenShellReadme.rtf" KeyPath="yes" Source="..\Localization\$(var.CS_LANG_FOLDER)\OpenShellReadme.rtf" Vital="yes" />
			</Component>
			<Component Id="ExplorerL10N.ini" Guid="660F2112-3133-4022-9F1E-BC3AED2EB475" Win64="$(var.CS_WIN64)">
				<File Id="ExplorerL10N.ini" KeyPath="yes" Source="..\ClassicExplorer\ExplorerL10N.ini" Vital="yes" />
			</Component>
			<Component Id="StartMenuL10N.ini" Guid="3F784CD2-63B8-46db-888E-5AC20852601E" Win64="$(var.CS_WIN64)">
				<File Id="StartMenuL10N.ini" KeyPath="yes" Source="..\StartMenu\StartMenuL10N.ini" Vital="yes" />
			</Component>
			<Component Id="StartMenuHelperL10N.ini" Guid="144CE4DC-0C77-4793-B79A-A32E48A90E64" Win64="$(var.CS_WIN64)">
				<File Id="StartMenuHelperL10N.ini" KeyPath="yes" Source="..\StartMenu\StartMenuHelper\StartMenuHelperL10N.ini" Vital="yes" />
			</Component>
			<Component Id="Update.exe" Guid="FB6C213F-B670-4888-8B2C-12E807E335A7" Win64="$(var.CS_WIN64)">
				<File Id="Update" KeyPath="yes" Source="Output\Update.exe" Checksum="yes" Vital="yes" />
			</Component>
			<Component Id="DesktopToasts.dll" Guid="B42157AF-3984-4796-8BD6-501FC5450FF1" Win64="$(var.CS_WIN64)">
				<File Id="DesktopToasts.dll" KeyPath="yes" Source="Output\DesktopToasts.dll" Checksum="yes" Vital="yes" />
			</Component>
			<Component Id="PolicyDefinitions.zip" Guid="580A15D0-4023-471d-9D82-9D63FBA42B5D" Win64="$(var.CS_WIN64)">
				<File Id="PolicyDefinitions.zip" KeyPath="yes" Source="Output\PolicyDefinitions.zip" Vital="yes" />
			</Component>
			<?if $(var.CS_LANG_NAME)!="en-US" ?>
			<Component Id="LanguageDll" Guid="A709B553-FBFA-4863-A9E5-CCD79CAF1560" Win64="$(var.CS_WIN64)">
				<File Id="LanguageDll" KeyPath="yes" Source="..\Localization\$(var.CS_LANG_FOLDER)\$(var.CS_LANG_NAME).dll" Checksum="yes" Vital="yes" />
			</Component>
			<?endif ?>
		</DirectoryRef>
		<DirectoryRef Id="Skins">
			<Component Id="ClassicSkin.skin" Guid="301CA0BC-1DD4-4A25-8E1E-FA1A0134A814" Win64="$(var.CS_WIN64)">
				<File Id="ClassicSkin.skin" KeyPath="yes" Checksum="yes" Source="Output\Classic Skin.skin" Vital="yes" />
			</Component>
			<Component Id="FullGlass.skin" Guid="B71131E1-ED7C-4EED-9289-528B50E2C8EE" Win64="$(var.CS_WIN64)">
				<File Id="FullGlass.skin" KeyPath="yes" Checksum="yes" Source="Output\Full Glass.skin" Vital="yes" />
			</Component>
			<Component Id="SmokedGlass.skin" Guid="19BF925A-85C0-4EFC-8F0C-091BFE5355FA" Win64="$(var.CS_WIN64)">
				<File Id="SmokedGlass.skin" KeyPath="yes" Checksum="yes" Source="Output\Smoked Glass.skin" Vital="yes" />
			</Component>
			<Component Id="WindowsAero.skin" Guid="31F56072-143D-4483-9590-E928CA6A4C5B" Win64="$(var.CS_WIN64)">
				<File Id="WindowsAero.skin" KeyPath="yes" Checksum="yes" Source="Output\Windows Aero.skin" Vital="yes" />
			</Component>
			<Component Id="WindowsBasic.skin" Guid="64F8BA21-1A66-45f8-9BA6-E27156DCAAAE" Win64="$(var.CS_WIN64)">
				<File Id="WindowsBasic.skin" KeyPath="yes" Checksum="yes" Source="Output\Windows Basic.skin" Vital="yes" />
			</Component>
			<Component Id="WindowsXPLuna.skin" Guid="FBC71683-D1B5-4F6C-A14C-AD9B555D10BB" Win64="$(var.CS_WIN64)">
				<File Id="WindowsXPLuna.skin" KeyPath="yes" Checksum="yes" Source="Output\Windows XP Luna.skin" Vital="yes" />
			</Component>
			<Component Id="Windows8.skin" Guid="3787BF83-4910-4008-8C0A-C82602AE80B7" Win64="$(var.CS_WIN64)">
				<File Id="Windows8.skin" KeyPath="yes" Checksum="yes" Source="Output\Windows 8.skin" Vital="yes" />
			</Component>
			<Component Id="Metro.skin" Guid="E7ADDABB-E019-4893-B0C8-200367EEEBAC" Win64="$(var.CS_WIN64)">
				<File Id="Metro.skin" KeyPath="yes" Checksum="yes" Source="Output\Metro.skin" Vital="yes" />
				<Condition>VersionNT&gt;601</Condition>
			</Component>
			<Component Id="ClassicSkin.skin7" Guid="24A14A38-B51B-4F6E-8922-95F868F78934" Win64="$(var.CS_WIN64)">
				<File Id="ClassicSkin.skin7" KeyPath="yes" Checksum="yes" Source="Output\Classic Skin.skin7" Vital="yes" />
			</Component>
			<Component Id="WindowsAero.skin7" Guid="4D2ED9E7-825A-4BC6-8EF9-ED142F6FE15F" Win64="$(var.CS_WIN64)">
				<File Id="WindowsAero.skin7" KeyPath="yes" Checksum="yes" Source="Output\Windows Aero.skin7" Vital="yes" />
			</Component>
			<Component Id="Windows8.skin7" Guid="BF69351E-763F-4A31-8180-7A39AA4541B9" Win64="$(var.CS_WIN64)">
				<File Id="Windows8.skin7" KeyPath="yes" Checksum="yes" Source="Output\Windows 8.skin7" Vital="yes" />
			</Component>
			<Component Id="Midnight.skin7" Guid="CE36C4AD-F3CB-4ae0-AC0A-845F5C7B3ED5" Win64="$(var.CS_WIN64)">
				<File Id="Midnight.skin7" KeyPath="yes" Checksum="yes" Source="Output\Midnight.skin7" Vital="yes" />
			</Component>
			<Component Id="Metro.skin7" Guid="4CA9B157-C098-4137-BD17-107C79CBCF44" Win64="$(var.CS_WIN64)">
				<File Id="Metro.skin7" KeyPath="yes" Checksum="yes" Source="Output\Metro.skin7" Vital="yes" />
				<Condition>VersionNT&gt;601</Condition>
			</Component>
			<Component Id="Metallic.skin7" Guid="2167BBCA-FD42-4285-AE00-9CDDDF436B30" Win64="$(var.CS_WIN64)">
				<File Id="Metallic.skin7" KeyPath="yes" Checksum="yes" Source="Output\Metallic.skin7" Vital="yes" />
			</Component>
		</DirectoryRef>
		<DirectoryRef Id="TARGETDIR">
			<Component Id="OpenShell" Guid="19EC9EFC-B901-4EAB-B800-6E98D2261077" Win64="$(var.CS_WIN64)">
				<RegistryKey Root="HKLM" Key="Software\OpenShell\OpenShell">
					<RegistryValue Type="integer" Name="Version" KeyPath="yes" Value="$(env.CS_VERSION_NUM)" />
					<RegistryValue Type="string" Name="Path" Value="[APPLICATIONFOLDER]" />
					<?if $(var.CS_LANG_NAME)!="en-US" ?>
					<RegistryValue Type="string" Name="DefaultLanguage" Value="$(var.CS_LANG_NAME)" />
					<?else ?>
					<RegistryValue Type="string" Name="DefaultLanguage" Value="" />
					<?endif ?>
				</RegistryKey>
			</Component>
			<Component Id="AutoRun" Guid="64987C22-72C7-419D-B5A5-D2E6CB4865B6" Win64="$(var.CS_WIN64)">
				<RegistryKey Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Run">
					<RegistryValue Value="&quot;[APPLICATIONFOLDER]StartMenu.exe&quot; -autorun" Type="string" Name="Open-Shell Start Menu" />
				</RegistryKey>
			</Component>
			<Component Id="TreatAs" Guid="B1E7462A-E1E2-47eb-A42C-7BD272D738AA" Win64="$(var.CS_WIN64)">
				<RegistryKey Root="HKCR" Key="CLSID\{ECD4FC4D-521C-11D0-B792-00A0C90312E1}\TreatAs" ForceDeleteOnUninstall="yes" />
			</Component>
			<Component Id="ToastActivator" Guid="3A0FDC31-D5D3-4C2E-9A0B-292CAB46DA87" Win64="$(var.CS_WIN64)">
				<RegistryKey Root="HKCR" Key="CLSID\{E407B70A-1FBD-4D5E-8822-231C69102472}\LocalServer32" ForceDeleteOnUninstall="yes">
					<RegistryValue Value="&quot;[APPLICATIONFOLDER]Update.exe&quot; -ToastActivated" Type="string" />
				</RegistryKey>
			</Component>
		</DirectoryRef>
		<DirectoryRef Id="StartMenuDir">
			<Component Id="HelpLink" Guid="D631C351-7BD4-42CE-813C-5D46347068AF">
				<Shortcut Id="HelpLink" Name="!(loc.HelpItem)" Advertise="no" Description="!(loc.HelpDesc)" Target="[APPLICATIONFOLDER]OpenShell.chm" WorkingDirectory="APPLICATIONFOLDER" />
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
			<Component Id="ReadmeLink" Guid="A54415C8-412E-4768-8829-8898122E4AED">
				<Shortcut Id="ReadmeLink" Name="!(loc.ReadmeItem)" Advertise="no" Description="!(loc.ReadmeDesc)" Target="[APPLICATIONFOLDER]OpenShellReadme.rtf" WorkingDirectory="APPLICATIONFOLDER" />
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
			<Component Id="UpdateSettingsLink" Guid="10B5A082-6C92-4EA7-AFF8-21AE3D2D7FE0">
				<Shortcut Id="UpdateSettingsLink" Name="!(loc.UpdateItem)" Advertise="no" Description="!(loc.UpdateSettingsDesc)" Target="[APPLICATIONFOLDER]Update.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.Update"/>
					<!-- Windows 7 doesn't recognize `System.AppUserModel.ToastActivatorCLSID` name so we have to use GUID directly -->
					<ShortcutProperty Key="{9F4C2855-9F79-4B39-A8D0-E1D42DE1D5F3}, 26" Value="{E407B70A-1FBD-4D5E-8822-231C69102472}"/>
				</Shortcut>
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
			<Component Id="ExplorerSettingsLink" Guid="6EC027F2-115D-4110-8189-DDAFC78169EC">
				<Shortcut Id="ExplorerSettingsLink" Name="!(loc.ExplorerItem)" Advertise="no" Description="!(loc.ExplorerSettingsDesc)" Target="[APPLICATIONFOLDER]ClassicExplorerSettings.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.ClassicExplorer.Settings" />
				</Shortcut>
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
			<Component Id="MenuSettingsLink" Guid="F2B638D3-EBE1-4C8F-9C53-08A4F21ACFA3">
				<Shortcut Id="MenuSettingsLink" Name="!(loc.StartMenuItem)" Advertise="no" Description="!(loc.StartSettingsDesc)" Target="[APPLICATIONFOLDER]StartMenu.exe" WorkingDirectory="APPLICATIONFOLDER" Arguments="-settings">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.StartMenu.Settings" />
				</Shortcut>
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
			<Component Id="IESettingsLink" Guid="10C0226C-22A9-49E4-AA65-C96AD7A504CC">
				<Shortcut Id="IESettingsLink" Name="!(loc.IEItem)" Advertise="no" Description="!(loc.IESettingsDesc)" Target="[APPLICATIONFOLDER]ClassicIE_32.exe" WorkingDirectory="APPLICATIONFOLDER">
					<ShortcutProperty Key="System.AppUserModel.ID" Value="OpenShell.ClassicIE.Settings" />
				</Shortcut>
				<CreateFolder />
				<Condition>START_MENU_FOLDER=1</Condition>
			</Component>
		</DirectoryRef>
		<DirectoryRef Id="SystemFolder">
			<Component Id="StartMenuHelper32.dll" Guid="3B06791F-61E6-4008-9869-A47AE617D809" Win64="no">
				<File Id="StartMenuHelper32.dll" KeyPath="yes" Source="Output\StartMenuHelper32.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
		</DirectoryRef>
		<DirectoryRef Id="System64Folder">
			<?if $(var.x64)=1 ?>
			<Component Id="StartMenuHelper64.dll" Guid="D103AD49-2C58-4109-9D26-AF1FAD0F556B" Win64="yes" DiskId="2">
				<File Id="StartMenuHelper64.dll" KeyPath="yes" Source="Output\x64\StartMenuHelper64.dll" Checksum="yes" SelfRegCost="0" Vital="yes" />
			</Component>
			<?endif ?>
		</DirectoryRef>
		<Icon Id="icon.ico" SourceFile="..\Setup\OpenShell.ico" />
		<Property Id="ARPPRODUCTICON" Value="icon.ico" />
		<Property Id="ApplicationFolderName" Value="Open-Shell" />
		<Property Id="WixAppFolder" Value="WixPerMachineFolder" />
		<Property Id="ALLUSERS" Value="1" />
		<Property Id="ARPHELPLINK" Value="https://github.com/Open-Shell/Open-Shell-Menu/issues" />
		<Property Id="ARPSIZE" Value="9000" />
		<Property Id="ARPURLINFOABOUT" Value="https://open-shell.github.io/Open-Shell-Menu" />
		<Property Id="ARPNOMODIFY" Value="1" />
		<Property Id="ARPNOREPAIR" Value="1" />
		<Property Id="START_MENU_FOLDER" Value="1" />
		<Property Id="NOSTART" Value="0" />
		<Property Id="IE_BUILD" Value="0">
			<RegistrySearch Id="IEBuild" Root="HKLM" Key="Software\Microsoft\Internet Explorer" Name="Build" Type="raw" />
		</Property>
		<Property Id="APPLICATIONFOLDER">
			<RegistrySearch Id="Path" Root="HKLM" Key="Software\OpenShell\OpenShell" Name="Path" Type="raw" Win64="$(var.CS_WIN64)" />
		</Property>
		<CustomAction Id="LaunchStartMenu" Impersonate="yes" ExeCommand="" FileKey="StartMenu.exe" Return="asyncNoWait" />
		<CustomAction Id="CloseStartMenu" Impersonate="yes" BinaryKey="SetupHelper.exe" Return="ignore" ExeCommand="exitSM" />
		<WixVariable Id="WixUIBannerBmp" Value="..\Setup\banner.jpg" />
		<WixVariable Id="WixUIDialogBmp" Value="..\Setup\dialog.jpg" />
		<Upgrade Id="$(var.CS_UPGRADE)">
			<UpgradeVersion Property="PREVIOUSVERSIONSINSTALLED" Maximum="$(env.CS_VERSION)" MigrateFeatures="yes" />
			<UpgradeVersion Property="NEWERPRODUCTFOUND" Minimum="$(env.CS_VERSION)" IncludeMinimum="yes" OnlyDetect="yes" />
		</Upgrade>
		<InstallExecuteSequence>
			<RemoveExistingProducts After="InstallInitialize" />
			<Custom Action="CloseStartMenu" Before="InstallValidate"><![CDATA[((!StartMenu=3) AND (&StartMenu=2)) OR PREVIOUSVERSIONSINSTALLED OR REINSTALL]]></Custom>
			<Custom Action="LaunchStartMenu" After="InstallFinalize"><![CDATA[(!StartMenu=3 OR &StartMenu=3) AND NOT REMOVE AND NOSTART<>1]]></Custom>
		</InstallExecuteSequence>
		<Binary Id="SetupHelper.exe" SourceFile="Output\SetupHelper.exe" />
		<Binary Id="dialog2.jpg" SourceFile="..\Setup\dialog2.jpg" />
		<Binary Id="web.ico" SourceFile="..\Setup\web.ico" />
	</Product>
</Wix>
